---
title: 표준 SQL 함수 정리
date: 2025-08-02 17:25 +0900
categories: [study]
tags: [sql]
author: <author_id>
description: 표준 SQL 함수와 관련 개념
mermaid: true
---

## SQL 표준 버전 개요

| **버전**      | **주요 추가 기능**                                                                 |
|---------------|-----------------------------------------------------------------------------------|
| SQL:1992      | - 기본 쿼리(`SELECT`)<br>- 조인(`INNER JOIN`, `LEFT JOIN`, `RIGHT JOIN`, `CROSS JOIN`)<br>- 그룹화(`GROUP BY`, `HAVING`)<br>- 조건문(`CASE`)<br>- 문자열 함수(`CONCAT`, `SUBSTRING`, `TRIM`)<br>- 집계 함수(`COUNT`, `SUM`, `AVG`, `MIN`, `MAX`)<br>- 논리 연산(`AND`, `OR`, `NOT`)<br>- 서브쿼리(`EXISTS`, `IN`)<br>- 집합 연산(`UNION`, `UNION ALL`, `INTERSECT`, `EXCEPT`) |
| SQL:1999      | - NULL 처리(`COALESCE`, `NULLIF`)<br>- 날짜/시간 함수(`EXTRACT`, `INTERVAL`)<br>- CTE(`WITH`, `WITH RECURSIVE`)<br>- 수학 함수(`CEIL`, `FLOOR`, `MOD`)<br>- 서브쿼리 확장(`ANY`, `ALL`) |
| SQL:2003      | - 윈도우 함수(`RANK`, `ROW_NUMBER`, `LEAD`, `LAG`, `FIRST_VALUE`, `LAST_VALUE`)<br>- 윈도우 집계 함수(`SUM`, `COUNT`, `AVG`) |
| SQL:2011      | - 윈도우 함수 확장(`LEAD`, `LAG` 정식화) |

## 집계 함수 (SQL:1992, SQL:1999)

| **함수** | **설명** | **사용법 예시** (PostgreSQL) |
| --- | --- | --- |
| COUNT() | 행 개수 계산 | `COUNT(*)`, `COUNT(DISTINCT column)` |
| SUM() | 숫자 합계 | `SUM(column)` |
| AVG() | 숫자 평균 | `AVG(column)` |
| MIN(), MAX() | 최소/최대값 | `MIN(column)`, `MAX(column)` |
| COALESCE() | NULL 값 대체 | `COALESCE(column, default)` |
| NULLIF() | 값 비교 후 NULL 반환 | `NULLIF(col1, col2)` |

## 조건문 (SQL:1992)

| **함수** | **설명** | **사용법 예시** (PostgreSQL) |
| --- | --- | --- |
| CASE | 조건부 로직 처리 | `CASE WHEN condition THEN value1 ELSE value2 END` |

## 조인과 서브쿼리 (SQL:1992)

| **개념** | **설명** | **사용법 예시** (PostgreSQL) |
| --- | --- | --- |
| INNER JOIN | 일치하는 행 결합 | `SELECT a.col FROM table1 a INNER JOIN table2 b ON a.id = b.id` |
| LEFT JOIN, RIGHT JOIN | 한쪽 테이블의 모든 행 포함 | `SELECT a.col FROM table1 a LEFT JOIN table2 b ON a.id = b.id` |
| CROSS JOIN | 모든 행 조합 (카티션 곱) | `SELECT a.col, b.col FROM table1 a CROSS JOIN table2 b` |
| EXISTS, IN | 서브쿼리로 존재 여부 확인 | `WHERE EXISTS (SELECT 1 FROM table2 WHERE col = table1.col)` |

## 윈도우 함수 (SQL:2003, SQL:2011)

| **함수** | **설명** | **사용법 예시** (PostgreSQL) |
| --- | --- | --- |
| RANK() | 동일 값에 같은 순위 부여, 다음 순위 건너뜀 (예: 1, 1, 3) | `RANK() OVER (PARTITION BY column ORDER BY column)` |
| DENSE_RANK() | 동일 값에 같은 순위 부여, 다음 순위 연속 (예: 1, 1, 2) | `DENSE_RANK() OVER (PARTITION BY column ORDER BY column)` |
| ROW_NUMBER() | 동일 값에도 고유 순위 부여 (예: 1, 2, 3) | `ROW_NUMBER() OVER (PARTITION BY column ORDER BY column)` |
| LEAD(), LAG() | 다음/이전 행 값 가져오기 | `LEAD(column) OVER (PARTITION BY column ORDER BY column)` |
| FIRST_VALUE(), LAST_VALUE() | 파티션 내 첫/마지막 값 | `FIRST_VALUE(column) OVER (PARTITION BY column ORDER BY column)` |
| SUM(), COUNT(), AVG() | 파티션 내 누적/집계 계산 | `SUM(column) OVER (PARTITION BY column ORDER BY column)` |

## 문자열 함수 (SQL:1992, SQL:1999)

| **함수** | **설명** | **사용법 예시** (PostgreSQL) |
| --- | --- | --- |
| CONCAT() | 문자열 결합 | `CONCAT(col1, col2)` |
|  |  |  |
| SUBSTRING() | 문자열 일부 추출 | `SUBSTRING(column FROM 1 FOR 3)` |
| TRIM(), LTRIM(), RTRIM() | 문자열 공백 제거 | `TRIM(BOTH FROM column)`, `LTRIM(column)`, `RTRIM(column)` |

## 날짜/시간 함수 (SQL:1999)

| **함수** | **설명** | **사용법 예시** (PostgreSQL) |
| --- | --- | --- |
| EXTRACT() | 날짜/시간에서 연도, 월 등 추출 | `EXTRACT(YEAR FROM date_column)` |
| INTERVAL | 날짜/시간 간격 처리 | `date_column + INTERVAL '1 day'` |

## 수학 함수 (SQL:1999)

| **함수** | **설명** | **사용법 예시** (PostgreSQL) |
| --- | --- | --- |
| CEIL() | 숫자 올림 | `CEIL(value)` |
| FLOOR() | 숫자 내림 | `FLOOR(value)` |
| MOD() | 나머지 연산 | `MOD(dividend, divisor)` |

## 기타 함수 (SQL:1992, SQL:1999)

| **함수** | **설명** | **사용법 예시** (PostgreSQL) |
| --- | --- | --- |
| ROUND() | 숫자 반올림 | `ROUND(value, 2)` |
| CAST() | 데이터 타입 변환 | `CAST(column AS TEXT)` |

## 집합 연산 (SQL:1992)

| **개념** | **설명** | **사용법 예시** (PostgreSQL) |
| --- | --- | --- |
| UNION, UNION ALL | 두 결과 집합 결합 (중복 제거/포함) | `SELECT col FROM table1 UNION SELECT col FROM table2` |
| INTERSECT | 두 결과 집합의 교집합 | `SELECT col FROM table1 INTERSECT SELECT col FROM table2` |
| EXCEPT | 첫 결과 집합에서 두 번째 집합 제외 | `SELECT col FROM table1 EXCEPT SELECT col FROM table2` |

## 논리 연산 및 서브쿼리 확장 (SQL:1992)

| **개념** | **설명** | **사용법 예시** (PostgreSQL) |
| --- | --- | --- |
| AND, OR, NOT | 조건 결합 | `WHERE col1 > 0 AND col2 IS NOT NULL` |
| ANY, ALL | 서브쿼리와 함께 비교 연산 | `WHERE column > ALL (SELECT value FROM table)` |

## 필수 개념 (SQL:1992, SQL:1999)

| **개념** | **설명** | **사용법 예시** (PostgreSQL) |
| --- | --- | --- |
| GROUP BY, HAVING | 데이터 집계 | `GROUP BY column HAVING COUNT(*) > 1` |
| 서브쿼리와 CTE | 복잡한 로직 단계별 분리 | `WITH cte AS (SELECT ...) SELECT FROM cte` |
| WITH RECURSIVE | 재귀 쿼리로 계층 구조 처리 | `WITH RECURSIVE cte AS (SELECT id FROM table WHERE parent_id IS NULL UNION ALL SELECT t.id FROM table t JOIN cte c ON t.parent_id = c.id) SELECT * FROM cte` |