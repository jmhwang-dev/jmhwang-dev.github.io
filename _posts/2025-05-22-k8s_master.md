---
title: Kubernetes ë…¸ë“œ êµ¬ì„± ì‹œ í•„ìš”í•œ ì»¤ë„ ë° ë„¤íŠ¸ì›Œí¬ ì„¤ì • ì •ë¦¬
date: 2025-05-22 16:50 +0900
author: <author_id>
categories: [study]
tags: [ubuntu, k8s]
description: Kubernetes ë…¸ë“œ êµ¬ì„± ì‹œ í•„ìš”í•œ ì»¤ë„ ë° ë„¤íŠ¸ì›Œí¬ ì„¤ì • ì •ë¦¬
mermaid: true
---

## ğŸ”§ Kubernetesë¥¼ ìœ„í•œ ì»¤ë„ ëª¨ë“ˆê³¼ sysctl ì„¤ì • ì„¤ëª…

ì´ ë¬¸ì„œëŠ” Kubernetes ë§ˆìŠ¤í„° ë…¸ë“œ ì„¤ì¹˜ ì‹œ í•„ìˆ˜ì ì¸ ì»¤ë„ ëª¨ë“ˆ ë¡œë“œì™€ sysctl ì„¤ì •ì˜ ëª©ì ê³¼ ì—­í• ì„ ì„¤ëª…í•¨.

---

### 1. ì»¤ë„ ëª¨ë“ˆ ë¡œë“œ

KubernetesëŠ” ì»¨í…Œì´ë„ˆì™€ ë„¤íŠ¸ì›Œí‚¹ ê¸°ëŠ¥ì„ ìœ„í•´ íŠ¹ì • ì»¤ë„ ëª¨ë“ˆì„ í•„ìš”ë¡œ í•¨.

#### âœ… ì‚¬ìš©ë˜ëŠ” ëª¨ë“ˆ

| ëª¨ë“ˆ ì´ë¦„ | ì„¤ëª… |
|-----------|------|
| `overlay` | containerdì—ì„œ ì‚¬ìš©í•˜ëŠ” ë ˆì´ì–´ë“œ íŒŒì¼ ì‹œìŠ¤í…œì„ ì§€ì›í•¨ |
| `br_netfilter` | ë¸Œë¦¬ì§€ ë„¤íŠ¸ì›Œí¬ íŠ¸ë˜í”½ì„ iptablesì—ì„œ ê°ì§€ ê°€ëŠ¥í•˜ê²Œ í•¨ |

ì´ ëª¨ë“ˆë“¤ì€ Ubuntuì˜ ë¦¬ëˆ…ìŠ¤ ì»¤ë„ì— ê¸°ë³¸ ë‚´ì¥ë˜ì–´ ìˆìœ¼ë‚˜, ìë™ìœ¼ë¡œ ë¡œë“œë˜ì§€ ì•Šì„ ìˆ˜ ìˆìœ¼ë¯€ë¡œ ìˆ˜ë™ìœ¼ë¡œ ë¡œë“œí•˜ê±°ë‚˜ ë¶€íŒ… ì‹œ ìë™ìœ¼ë¡œ ë¡œë“œë˜ë„ë¡ ì„¤ì •í•´ì•¼ í•¨.

#### âœ… ì„¤ì • ë°©ë²• (Ansible ì˜ˆì‹œ)

```yaml
- name: Enable kernel modules for Kubernetes
  copy:
    dest: /etc/modules-load.d/k8s.conf
    content: |
      overlay
      br_netfilter
    mode: '0644'

- name: Load kernel modules now
  shell: |
    modprobe overlay
    modprobe br_netfilter
```

---

### 2. sysctl ë„¤íŠ¸ì›Œí¬ ì„¤ì •

sysctlì€ ë¦¬ëˆ…ìŠ¤ ì»¤ë„ì˜ ë„¤íŠ¸ì›Œí¬ íŠ¸ë˜í”½ ë™ì‘ì„ ì œì–´í•˜ëŠ” ì„¤ì • ì¸í„°í˜ì´ìŠ¤ì„. Kubernetesì˜ pod-to-pod í†µì‹ ê³¼ ë„¤íŠ¸ì›Œí¬ ì •ì±… ì‘ë™ì„ ìœ„í•´ ë‹¤ìŒê³¼ ê°™ì€ ê°’ì´ í•„ìš”í•¨.

#### âœ… ì„¤ì •í•  sysctl íŒŒë¼ë¯¸í„°

| íŒŒë¼ë¯¸í„° | ì„¤ëª… |
|----------|------|
| `net.bridge.bridge-nf-call-iptables` | ë¸Œë¦¬ì§€ ë„¤íŠ¸ì›Œí¬ íŠ¸ë˜í”½ì„ iptablesì—ì„œ í•„í„°ë§ ê°€ëŠ¥í•˜ê²Œ ì„¤ì •í•¨ |
| `net.bridge.bridge-nf-call-ip6tables` | IPv6ìš© ë™ì¼ ì„¤ì • (IPv6 ì‚¬ìš© ì‹œ í•„ìš”) |
| `net.ipv4.ip_forward` | IP íŒ¨í‚·ì„ ë‹¤ë¥¸ ì¸í„°í˜ì´ìŠ¤ë¡œ ë¼ìš°íŒ…í•  ìˆ˜ ìˆë„ë¡ ì„¤ì •í•¨ |

ì´ ì„¤ì •ì´ ì—†ìœ¼ë©´ pod ê°„ í†µì‹ ì´ë‚˜ CNI í”ŒëŸ¬ê·¸ì¸ì˜ ë„¤íŠ¸ì›Œí¬ ì •ì±…ì´ ì •ìƒì ìœ¼ë¡œ ì‘ë™í•˜ì§€ ì•Šì„ ìˆ˜ ìˆìŒ.

#### âœ… ì„¤ì • ë°©ë²• (Ansible ì˜ˆì‹œ)

```yaml
- name: Set sysctl parameters for Kubernetes networking
  copy:
    dest: /etc/sysctl.d/k8s.conf
    content: |
      net.bridge.bridge-nf-call-iptables = 1
      net.bridge.bridge-nf-call-ip6tables = 1
      net.ipv4.ip_forward = 1
    mode: '0644'

- name: Apply sysctl parameters
  command: sysctl --system
```

---

### âœ… ìš”ì•½

| êµ¬ì„± ìš”ì†Œ | ëª©ì  | í•„ìš”í•œ ëŒ€ìƒ |
|-----------|------|-------------|
| `overlay` | ì»¨í…Œì´ë„ˆ ì´ë¯¸ì§€ íŒŒì¼ì‹œìŠ¤í…œ ì§€ì› | containerd |
| `br_netfilter` | ë¸Œë¦¬ì§€ íŠ¸ë˜í”½ì„ iptablesë¡œ ì „ë‹¬ | kube-proxy, CNI |
| `net.ipv4.ip_forward` | IP ë¼ìš°íŒ… í™œì„±í™” | ëª¨ë“  ë…¸ë“œ |
| `bridge-nf-call-*` | iptables ê¸°ë°˜ í•„í„°ë§ í™œì„±í™” | CNI í”ŒëŸ¬ê·¸ì¸ ì „ì²´ |

ì´ ì„¤ì •ì´ ë¹ ì§€ê±°ë‚˜ ì˜ëª» ì ìš©ë˜ë©´ pod ê°„ í†µì‹  ì¥ì• , ë„¤íŠ¸ì›Œí¬ ì •ì±… ì‹¤íŒ¨, ì„œë¹„ìŠ¤ ë…¸ì¶œ ë¬¸ì œ ë“±ì´ ë°œìƒí•  ìˆ˜ ìˆìŒ.